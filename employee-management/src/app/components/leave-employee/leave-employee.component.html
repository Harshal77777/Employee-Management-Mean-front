<div class="leave-container">
  <h2>Leave Requests</h2>

  <mat-table *ngIf="leaveRequests.length; else noRequests" [dataSource]="leaveRequests" class="mat-elevation-z8">
    
    <!-- Employee Name -->
    <ng-container matColumnDef="employee">
      <mat-header-cell *matHeaderCellDef> Employee </mat-header-cell>
      <mat-cell *matCellDef="let leave"> {{ leave.employeeId.name }} </mat-cell>
    </ng-container>

    <!-- Employee Email -->
    <ng-container matColumnDef="email">
      <mat-header-cell *matHeaderCellDef> Email </mat-header-cell>
      <mat-cell *matCellDef="let leave"> {{ leave.employeeId.email }} </mat-cell>
    </ng-container>

    <!-- Leave Reason -->
    <ng-container matColumnDef="reason">
      <mat-header-cell *matHeaderCellDef> Reason </mat-header-cell>
      <mat-cell *matCellDef="let leave"> {{ leave.reason }} </mat-cell>
    </ng-container>

    <!-- Leave Date -->
    <ng-container matColumnDef="date">
      <mat-header-cell *matHeaderCellDef> Date </mat-header-cell>
      <mat-cell *matCellDef="let leave"> {{ leave.date | date:'shortDate' }} </mat-cell>
    </ng-container>

    <!-- Leave Status -->
    <ng-container matColumnDef="status">
      <mat-header-cell *matHeaderCellDef> Status </mat-header-cell>
      <mat-cell *matCellDef="let leave">
        <span [ngClass]="{'approved': leave.status === 'approved', 'rejected': leave.status === 'rejected'}">
          {{ leave.status | uppercase }}
        </span>
      </mat-cell>
    </ng-container>

    <!-- Actions (Approve/Reject for Admins) -->
    <ng-container matColumnDef="actions" *ngIf="isAdmin">
      <mat-header-cell *matHeaderCellDef> Actions </mat-header-cell>
      <mat-cell *matCellDef="let leave">
        <button mat-button color="primary" (click)="confirmAction(leave._id, 'approved')">Approve</button>
        <button mat-button color="warn" (click)="confirmAction(leave._id, 'rejected')">Reject</button>
      </mat-cell>
    </ng-container>

    <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
    <mat-row *matRowDef="let row; columns: displayedColumns;"></mat-row>
  </mat-table>

  <ng-template #noRequests>
    <p>No leave requests found.</p>
  </ng-template>
</div>

